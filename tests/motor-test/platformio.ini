; ================== PlatformIO unified config ==================
; Two selectable environments:
;   - esp32dev_wheel_simple    -> builds src/WheelSimple.cpp (encoder + motor)
;   - esp32dev_motor_smoketest -> builds src/MotorSmokeTest.cpp (motor-only smoke test)
;
; In VSCode: click the PlatformIO status bar target to switch env.
; CLI upload examples:
;   pio run -e esp32dev_wheel_simple    -t upload
;   pio run -e esp32dev_motor_smoketest -t upload
; Serial Monitor:
;   pio device monitor -e esp32dev_wheel_simple
;   pio device monitor -e esp32dev_motor_smoketest

[platformio]
default_envs = base
; -------- Base settings both envs share --------
[env:base]
platform = atmelavr
board    = uno
framework = arduino

; Serial monitor & upload quality-of-life
monitor_speed   = 9600
monitor_filters = time, colorize, esp32_exception_decoder
upload_speed    = 921600

; Modern C++
build_unflags = -std=gnu++11
build_flags   = -std=gnu++17


; -------- Encoder + Motor (wheel logic) --------
[env:esp32dev_wheel_simple]
extends = env:base
; Only compile this file for this env (avoid multiple setup/loop)
build_src_filter = +<WheelSimple.cpp>

; Optional: define spokes default here (your code can read WHEEL_SPOKES)
; build_flags = -std=gnu++17 -D WHEEL_SPOKES=5

; -------- Motor-only smoke test --------
[env:esp32dev_motor_smoketest]
extends = env:base
; Only compile the smoke test file
build_src_filter = +<MotorSmokeTest.cpp>
